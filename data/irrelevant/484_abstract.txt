The invention discloses a power takeoff and power generation system for carrying tools such as road rail and overwater tools The power takeoff and power generation system comprises an overall system wherein the overall system is composed of one or more permanent magnet motors zero or more storage batteries and a multiinput power converter and the multiinput power converter is composed ofa threestage circuit topology a precedingstage singlepath input or multipath input DCDC boostbuck conversion circuit an intermediatestage power collection bus capacitor and a backwardstage DCAC conversion circuit The power takeoff and power generation system has higher efficiency reduces the influence on the driving force of a carrying tool to the maximum extent can control the input power of one or more generators with different voltages frequencies phases and powers which are simultaneously accessed in real time so as to meet the requirement that primary power supplies withdifferent output characteristics are controlled to operate in parallel can be connected with one or more storage battery packs at the same time can control the power flow in real time according to the output power condition of the generator achieves the energy storage and power compensation functions adopts threephase fourbridgearm topological output and has great phase shift load capacityand reactive power load capacity