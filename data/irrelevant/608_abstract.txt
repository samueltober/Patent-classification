A device comprising a power converter one or more power terminals configured to be connected to a power source and one or more load terminals The apparatus further includes two or more energy storage terminals configured to connect to two or more electrical energy storage devices Two or more protection circuits included in the device are electrically connected between the corresponding energy storage terminal and the power converter and each of the protection circuits has one protection circuit The two or more protection circuits are configured to disconnect the corresponding terminal from the power converter after the corresponding one of the electrical energy storage devices fails